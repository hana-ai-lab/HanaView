Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/app/backend/data_fetcher.py", line 10, in <module>
    import pandas as pd
ModuleNotFoundError: No module named 'pandas'
2025-09-16 13:27:24,868 - __main__ - INFO - --- Starting Report Generation ---
2025-09-16 13:27:24,883 - __main__ - INFO - Generating AI commentary...
2025-09-16 13:27:24,884 - __main__ - INFO - Calling OpenAI API (max_completion_tokens=500)...
2025-09-16 13:27:25,407 - __main__ - ERROR - OpenAI API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 13:27:25,407 - __main__ - ERROR - Failed to generate and parse AI commentary: [E005] API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 13:27:25,407 - __main__ - INFO - Generating AI news analysis...
2025-09-16 13:27:25,407 - __main__ - INFO - Calling OpenAI API (max_completion_tokens=1024)...
2025-09-16 13:27:25,541 - __main__ - ERROR - OpenAI API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 13:27:25,541 - __main__ - ERROR - Could not generate AI news: [E005] API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 13:27:25,541 - __main__ - INFO - Generating heatmap AI commentary...
2025-09-16 13:27:25,541 - __main__ - INFO - Calling OpenAI API (max_completion_tokens=700)...
2025-09-16 13:27:25,639 - __main__ - ERROR - OpenAI API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 13:27:25,639 - __main__ - ERROR - Failed to generate and parse AI commentary for sp500: [E005] API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 13:27:25,640 - __main__ - INFO - Calling OpenAI API (max_completion_tokens=700)...
2025-09-16 13:27:25,739 - __main__ - ERROR - OpenAI API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 13:27:25,739 - __main__ - ERROR - Failed to generate and parse AI commentary for nasdaq: [E005] API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 13:27:25,739 - __main__ - INFO - Generating AI column...
2025-09-16 13:27:25,753 - __main__ - INFO - Generating Tuesday-Friday daily column.
2025-09-16 13:27:25,754 - __main__ - INFO - Calling OpenAI API (max_completion_tokens=2048)...
2025-09-16 13:27:26,010 - __main__ - ERROR - OpenAI API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 13:27:26,010 - __main__ - ERROR - Failed to generate and parse AI column: [E005] API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 13:27:26,138 - __main__ - INFO - --- Report Generation Completed. Saved to data/data_2025-09-16.json ---
2025-09-16 13:27:26,139 - __main__ - INFO - Cleaning up old data files...
2025-09-16 14:06:27,692 - __main__ - INFO - --- Starting Report Generation ---
2025-09-16 14:06:27,768 - __main__ - INFO - Generating AI commentary...
2025-09-16 14:06:27,768 - __main__ - INFO - Calling OpenAI API (max_completion_tokens=500)...
2025-09-16 14:06:28,320 - __main__ - ERROR - OpenAI API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 14:06:28,320 - __main__ - ERROR - Failed to generate and parse AI commentary: [E005] API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 14:06:28,320 - __main__ - INFO - Generating AI news analysis...
2025-09-16 14:06:28,320 - __main__ - INFO - Calling OpenAI API (max_completion_tokens=1024)...
2025-09-16 14:06:28,431 - __main__ - ERROR - OpenAI API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 14:06:28,431 - __main__ - ERROR - Could not generate AI news: [E005] API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 14:06:28,431 - __main__ - INFO - Generating heatmap AI commentary...
2025-09-16 14:06:28,432 - __main__ - INFO - Calling OpenAI API (max_completion_tokens=700)...
2025-09-16 14:06:28,547 - __main__ - ERROR - OpenAI API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 14:06:28,547 - __main__ - ERROR - Failed to generate and parse AI commentary for sp500: [E005] API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 14:06:28,547 - __main__ - INFO - Calling OpenAI API (max_completion_tokens=700)...
2025-09-16 14:06:28,680 - __main__ - ERROR - OpenAI API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 14:06:28,680 - __main__ - ERROR - Failed to generate and parse AI commentary for nasdaq: [E005] API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/app/backend/data_fetcher.py", line 1290, in <module>
    fetcher.generate_report()
  File "/app/backend/data_fetcher.py", line 1252, in generate_report
    self.generate_column()
  File "/app/backend/data_fetcher.py", line 961, in generate_column
    today = datetime.now(pytz.timezone('Asia/Tokyo'))
                         ^^^^
NameError: name 'pytz' is not defined
2025-09-16 14:09:32,017 - __main__ - INFO - --- Starting Report Generation ---
2025-09-16 14:09:32,071 - __main__ - INFO - Generating AI commentary...
2025-09-16 14:09:32,072 - __main__ - INFO - Calling OpenAI API (max_completion_tokens=500)...
2025-09-16 14:09:32,497 - __main__ - ERROR - OpenAI API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 14:09:32,497 - __main__ - ERROR - Failed to generate and parse AI commentary: [E005] API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 14:09:32,497 - __main__ - INFO - Generating AI news analysis...
2025-09-16 14:09:32,497 - __main__ - INFO - Calling OpenAI API (max_completion_tokens=1024)...
2025-09-16 14:09:32,602 - __main__ - ERROR - OpenAI API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 14:09:32,602 - __main__ - ERROR - Could not generate AI news: [E005] API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 14:09:32,602 - __main__ - INFO - Generating heatmap AI commentary...
2025-09-16 14:09:32,603 - __main__ - INFO - Calling OpenAI API (max_completion_tokens=700)...
2025-09-16 14:09:32,702 - __main__ - ERROR - OpenAI API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 14:09:32,703 - __main__ - ERROR - Failed to generate and parse AI commentary for sp500: [E005] API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 14:09:32,703 - __main__ - INFO - Calling OpenAI API (max_completion_tokens=700)...
2025-09-16 14:09:32,800 - __main__ - ERROR - OpenAI API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 14:09:32,800 - __main__ - ERROR - Failed to generate and parse AI commentary for nasdaq: [E005] API error: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 14:09:32,875 - __main__ - INFO - Generating daily column...
2025-09-16 14:09:33,190 - __main__ - ERROR - Error generating column: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-xxxxx*********************xxxx. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-09-16 14:09:33,381 - __main__ - INFO - --- Report Generation Completed. Saved to data/data_2025-09-16.json ---
2025-09-16 14:09:33,381 - __main__ - INFO - Cleaning up old data files...
